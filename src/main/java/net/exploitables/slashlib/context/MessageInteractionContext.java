package net.exploitables.slashlib.context;

import discord4j.core.event.domain.interaction.MessageInteractionEvent;
import discord4j.core.object.entity.Guild;
import discord4j.core.object.entity.Member;
import discord4j.core.object.entity.Message;
import discord4j.core.object.entity.User;
import discord4j.core.object.entity.channel.MessageChannel;
import discord4j.core.object.entity.channel.TopLevelGuildChannel;

/**
 * Context provided to a Message Command (context menu).
 * Created from the required data set by the command in a {@link UserInteractionContextBuilder}
 */
public class MessageInteractionContext {
    private final MessageInteractionEvent event;
    private final Guild guild;
    private final MessageChannel messageChannel;
    private final TopLevelGuildChannel guildChannel;
    private final Message targetMessage;
    private final User messageAuthor;
    private final Member messageAuthorAsMember;
    private final User callingUser;
    private final Member callingUserAsMember;

    public MessageInteractionContext(MessageInteractionContextBuilder builder) {
        this.event                  = builder.event;
        this.guild                  = builder.guild;
        this.messageChannel         = builder.messageChannel;
        this.guildChannel           = builder.topLevelGuildChannel;
        this.targetMessage          = builder.targetMessage;
        this.messageAuthor          = builder.messageAuthor;
        this.messageAuthorAsMember  = builder.messageAuthorAsMember;
        this.callingUser            = builder.user;
        this.callingUserAsMember    = builder.member;
    }

    /** @return the {@link MessageInteractionEvent} which corresponding to this interaction */
    public MessageInteractionEvent getEvent()       { return event; }

    /** @return the {@link Guild} this interaction was created in *if requested* */
    public Guild getGuild()                         { return guild; }
    /** @return the {@link MessageChannel} this interaction was created in *if requested* */
    public MessageChannel getMessageChannel()       { return messageChannel; }
    /** @return the {@link TopLevelGuildChannel} this interaction was created in *if requested* */
    public TopLevelGuildChannel getGuildChannel()   { return guildChannel; }
    /** @return the {@link Message} this interaction was called on *if requested* */
    public Message getTargetMessage()               { return targetMessage; }
    /** @return the {@link User} who authored the {@link Message} this interaction was called on *if requested* */
    public User getMessageAuthor()                  { return messageAuthor; }
    /** @return the {@link Member} who authored the {@link Message} this interaction was called on *if requested* */
    public Member getMessageAuthorAsMember()        { return messageAuthorAsMember; }
    /** @return the {@link User} that created this interaction *if requested* */
    public User getCallingUser()                    { return callingUser; }
    /** @return the {@link Member} that created this interaction *if requested* */
    public Member getCallingMember()                { return callingUserAsMember; }
}
