package net.exploitables.slashlib.examples;

import discord4j.core.DiscordClient;
import discord4j.core.GatewayDiscordClient;

import java.util.Objects;

/**
 * This isn't actually an example for SlashLib, this just deletes all slash commands for testing.
 */
public class ExampleDeleteAllCommands {
    public static void main(String[] args) {
        DiscordClient client = DiscordClient.create(args[0]);

        GatewayDiscordClient gateway = client.gateway()
            .login()
            .block();

        Long applicationId = client.getApplicationId().block();
        Objects.requireNonNull(applicationId);
        client.getApplicationService().getGlobalApplicationCommands(applicationId)
            .doOnNext(acd -> System.out.println("Deleting Command: " + acd.name()))
            .flatMap(acd -> client.getApplicationService().deleteGlobalApplicationCommand(applicationId, Long.parseLong(acd.id())))
            .blockLast();

        //noinspection ConstantConditions
        gateway.logout().block();
    }
}
