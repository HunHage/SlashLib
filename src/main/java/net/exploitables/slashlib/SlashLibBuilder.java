package net.exploitables.slashlib;

import discord4j.core.event.domain.interaction.SlashCommandEvent;
import net.exploitables.slashlib.commands.BaseCommand;
import net.exploitables.slashlib.commands.GroupCommand;
import net.exploitables.slashlib.commands.InvalidCommandLocationException;
import net.exploitables.slashlib.commands.TopCommand;

import java.util.ArrayList;
import java.util.List;

/**
 * A builder for {@link SlashLib} to customize the components of it.
 */
public class SlashLibBuilder {
    SlashCommandEventReceiver receiver;
    List<BaseCommand> commands;

    protected SlashLibBuilder() {
        this.receiver = null;
        this.commands = new ArrayList<>();
    }

    /**
     * Add a command to be registered when building a new {@link SlashLib}.
     * An assertion is done to verify the command is an instance of {@link TopCommand} or {@link GroupCommand}
     * @param command the command to add to the {@link CommandRegister}
     * @return this instance
     */
    public SlashLibBuilder addCommand(BaseCommand command) {
        if (!(command instanceof TopCommand || command instanceof GroupCommand)) {
            throw new InvalidCommandLocationException(command);
        }
        commands.add(command);
        return this;
    }

    /**
     * Set the method of receiving {@link SlashCommandEvent}s
     * @param receiver the method which will receive {@link SlashCommandEvent}s to process
     * @return this instance
     */
    public SlashLibBuilder setReceiver(SlashCommandEventReceiver receiver) {
         this.receiver = receiver;
         return this;
    }

    /**
     * Create a new {@link SlashLib} with the set values overriding the defaults.
     * @return a created {@link SlashLib} instance from this builder
     */
    public SlashLib build() {
        return SlashLib.create(this);
    }
}
