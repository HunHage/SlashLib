package net.exploitables.slashlib;

import discord4j.core.event.domain.interaction.ChatInputInteractionEvent;
import discord4j.core.event.domain.interaction.MessageInteractionEvent;
import discord4j.core.event.domain.interaction.UserInteractionEvent;
import discord4j.core.object.command.ApplicationCommandInteraction;
import net.exploitables.slashlib.commands.standard.MessageCommand;
import net.exploitables.slashlib.commands.standard.TopCommand;
import net.exploitables.slashlib.commands.standard.TopGroupCommand;
import net.exploitables.slashlib.commands.standard.UserCommand;
import net.exploitables.slashlib.context.*;

import java.lang.reflect.Constructor;
import java.util.List;

public class SlashLibBuilder
        extends GenericSlashLibBuilder<
        ChatInputContext, ChatInputContextBuilder,
        MessageContext, MessageContextBuilder,
        UserContext, UserContextBuilder
        > {

    private SlashLibBuilder(Class<ChatInputContext> chatInputContextClass,
                            Class<ChatInputContextBuilder> chatInputContextBuilderClass,
                            Constructor<ChatInputContextBuilder> chatInputContextBuilderConstructor,
                            Class<MessageContext> messageContextClass,
                            Class<MessageContextBuilder> messageContextBuilderClass,
                            Constructor<MessageContextBuilder> messageContextBuilderConstructor,
                            Class<UserContext> userContextClass,
                            Class<UserContextBuilder> userContextBuilderClass,
                            Constructor<UserContextBuilder> userContextBuilderConstructor) {
        super(chatInputContextClass,
                chatInputContextBuilderClass,
                chatInputContextBuilderConstructor,
                messageContextClass,
                messageContextBuilderClass,
                messageContextBuilderConstructor,
                userContextClass,
                userContextBuilderClass,
                userContextBuilderConstructor);
    }

    public static SlashLibBuilder create() {
        try {
            Constructor<ChatInputContextBuilder> chatInputContextBuilderConstructor = ChatInputContextBuilder.class
                .getConstructor(
                    ChatInputInteractionEvent.class,
                    ApplicationCommandInteraction.class,
                    List.class);
            Constructor<MessageContextBuilder> messageContextBuilderConstructor = MessageContextBuilder.class
                .getConstructor(MessageInteractionEvent.class);
            Constructor<UserContextBuilder> userContextBuilderConstructor = UserContextBuilder.class
                .getConstructor(UserInteractionEvent.class);

            return new SlashLibBuilder(
                ChatInputContext.class, ChatInputContextBuilder.class, chatInputContextBuilderConstructor,
                MessageContext.class, MessageContextBuilder.class, messageContextBuilderConstructor,
                UserContext.class, UserContextBuilder.class, userContextBuilderConstructor);
        } catch (NoSuchMethodException nsme) {
            // Should not occur under right conditions, as we know we have the correct setup to access the constructors
            throw new RuntimeException("No valid constructor for a builder found, this may be a Java version incompatibility.", nsme);
        }
    }

    public SlashLibBuilder addGlobalChatCommand(TopCommand command) {
        return (SlashLibBuilder) super.addGlobalChatCommand(command);
    }

    public SlashLibBuilder addGlobalChatCommand(TopGroupCommand command) {
        return (SlashLibBuilder) super.addGlobalChatCommand(command);
    }

    public SlashLibBuilder addGlobalUserCommand(UserCommand command) {
        return (SlashLibBuilder) super.addGlobalUserCommand(command);
    }

    public SlashLibBuilder addGlobalMessageCommand(MessageCommand command) {
        return (SlashLibBuilder) super.addGlobalMessageCommand(command);
    }

    public SlashLibBuilder addGuildChatCommand(TopCommand command) {
        return (SlashLibBuilder) super.addGuildChatCommand(command);
    }

    public SlashLibBuilder addGuildChatCommand(TopGroupCommand command) {
        return (SlashLibBuilder) super.addGuildChatCommand(command);
    }

    public SlashLibBuilder addGuildUserCommand(UserCommand command) {
        return (SlashLibBuilder) super.addGuildUserCommand(command);
    }

    public SlashLibBuilder addGuildMessageCommand(MessageCommand command) {
        return (SlashLibBuilder) super.addGuildMessageCommand(command);
    }

    public SlashLib build() {
        return SlashLib.create(this);
    }
}
